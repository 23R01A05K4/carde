from sklearn.datasets import load_iris
import pandas as pd

dataset = load_iris()
X = pd.DataFrame(dataset.data)
X.columns = ['Sepal_Length', 'Sepal_Width', 'Petal_Length', 'Petal_Width']
print(X)

Y = pd.DataFrame(dataset.target)
Y.columns = ['Targets']
print(Y)

from sklearn.model_selection import train_test_split
X_train, X_test, Y_train, Y_test = train_test_split(dataset.data, dataset.target, test_size=0.1)

print("Dataset is split into training and testing...")
print("Size of training data and its labels:", X_train.shape, Y_train.shape)
print("Size of testing data and its labels:", X_test.shape, Y_test.shape)

for i in range(len(dataset.target_names)):
    print("Label", i, "-", str(dataset.target_names[i]))

from sklearn.neighbors import KNeighborsClassifier
classifier = KNeighborsClassifier(n_neighbors=3)
classifier.fit(X_train, Y_train)

Y_pred = classifier.predict(X_test)

print("Results of classification using k-nn with k=3")
for i in range(len(X_test)):
    print("Sample:", str(X_test[i]), "Actual-label:", str(Y_test[i]), "Predict-label:", str(Y_pred[i]))

print("Classification Accuracy:", classifier.score(X_test, Y_test))

from sklearn.metrics import classification_report, confusion_matrix
print("Confusion Matrix")
print(confusion_matrix(Y_test, Y_pred))

print("Accuracy Metrics")
print(classification_report(Y_test, Y_pred))
